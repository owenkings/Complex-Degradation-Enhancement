# 复杂降质图像感知增强课程设计

## 一、课设背景

真实场景下，由于成像环境的复杂多样性，实际拍摄到的图像会受到多重降质因素的影响（如雾天、低对比度、光照、模糊等），降质线索会破坏图像的统计与结构特性，引起图像质量下降。现有的图像识别模型大多基于高质量图像进行预训练，当输入图像为降质图像时，其精度会发生剧烈下降。本课设的目的在于使用图像增强与特征增强两种方法对降质图像进行增强处理，并对比两种增强方式的性能差异。

## 二、实验内容

### （一）基于图像增强的降质图像识别

每组选择至少1种All-in-One的图像增强算法对降质图像进行增强处理，具体要求如下：

**Step1**：使用给定训练集（CUB-C）对All-in-One图像增强算法进行微调或从头训练（要求在实验报告中给出Loss曲线），然后使用训练的模型测试测试集(ImageNet-Val-C)图像（5W张，1000类，每类50张）；

**Step2**：计算增强后图像的PSNR和SSIM，并将增强后的图像输入VGG16网络测试识别精度；

### （二）基于特征增强的降质图像识别

参考CVPR2020 DDP论文的训练与测试方法，实现基于Mamba的特征增强，具体要求如下：

<!--CVPR2020论文方法为：一、CVPR2020 DDP（Deep Degradation Prior）论文中的训练与测试方法（可直接映射到你的 Task2）

DDP 的核心是：不做图像域增强，而是在 VGG 的浅层特征空间把“降质特征”对齐回“清晰特征”，并作为可插拔模块接入分类网络。

1) 训练阶段（Feature-space supervised reconstruction）

输入数据：成对的 (degraded image, clean image)，不需要语义标签。

SPL（Shallow Pretrained Layers）：固定一个预训练分类网络的浅层（论文例子：VGG16 的 conv2_2），提取：

DF = SPL(degraded)

CF = SPL(clean)

FDM（Feature De-drifting Module）：学习把 DF → EF（增强特征），并用残差方式融合：EF = DF + FDM(… , DF)

损失函数：对齐目标是 CF，使用 MSE（论文写得非常明确）

可训练参数：只更新 FDM（或你这里的 Mamba Feature Enhancer），SPL 固定。

2) 测试阶段（Plug-in to classification network）

把训练好的模块插到分类网络中：SPL → (FDM/Enhancer) → DPL（Deep Pretrained Layers）。

测试输入只有 degraded image：
logits = DPL( Enhancer( SPL(degraded) ) )

论文评测主要在 ImageNet-C，并强调其 50k/1000类规模。

（你们课程现在把 ImageNet-C 简化成 Ver2，因此只需要按老师说的指标做即可。） -->

**Step1**：使用预训练网络VGG16的浅层网络提取降质图像的降质特征(浅层网络权重Fix)，并设计一种基于Mamba的增强模块，对降质特征进行增强处理（监督信号为对应清晰图像的浅层特征）；

**Step2**：使用上述基于Mamba的增强模块对测试集中的降质图像进行特征增强(ImageNet-Val-C)，将增强后的特征输入到VGG16的后续网络进行识别；

**Step3**：对（一）中和（二）中的识别结果进行对比和分析。

## 三、附加题

### （三）基于VGG浅层表征空间的图像增强

**Step1**：首先对VGG16的浅层特征设计一个解码器，实现特征到图像的解码；

**Step2**：将（二）中增强后的特征输入到Step1中的解码器中，解码出增强后图像；

## 四、实验要求

1. 撰写和提交实验报告；
2. 提交原始实验代码（训练与测试代码）+训练好的模型；
3. 在实验报告中注明小组人员分工；

## 五、候选All-in-One算法

- MPRNet: https://github.com/swz30/MPRNet
- MIRNet: https://github.com/swz30/MIRNet
- NAFNet: https://github.com/megvii-research/NAFNet
- Restormer: https://github.com/swz30/Restormer
- MambaIR: GitHub - csguoh/MambaIR
- PromptIR: https://github.com/va1shn9v/PromptIR
- IDR: https://github.com/JingHao99/IDR-Ingredients-oriented-Degradation-Reformulation
- NDR-Restore: https://github.com/mdyao/NDR-Restore
- Onerestore: https://github.com/gy65896/OneRestore
- MoCEIR: https://github.com/eduardzamfir/MoCE-IR
- AdaIR: https://github.com/c-yn/AdaIR